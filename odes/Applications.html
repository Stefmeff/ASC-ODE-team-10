

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>3. Applications &#8212; ASC-ODE  Introduction to Scientific Computing</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'odes/Applications';</script>
    <link rel="shortcut icon" href="../_static/ASC_Logo_transparent_300ppi_RGB.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="2. Time Stepping Methods" href="TimeSteppingMethods.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/ASC_Logo_transparent_300ppi_RGB.png" class="logo__image only-light" alt="ASC-ODE  Introduction to Scientific Computing - Home"/>
    <script>document.write(`<img src="../_static/ASC_Logo_transparent_300ppi_RGB.png" class="logo__image only-dark" alt="ASC-ODE  Introduction to Scientific Computing - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to ASC-ODE’s documentation!
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">ASC-ODE  Team 10</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="scope_and_tasks.html">1. Project Scope and Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="building.html">2. Building the Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="FunctionAlgebra.html">3. Function Algebra</a></li>
<li class="toctree-l1"><a class="reference internal" href="TimeSteppingMethods.html">4. Time Stepping Methods</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">3. Applications</a></li>

</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/Stefmeff/ASC-ODE-team-10" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/Stefmeff/ASC-ODE-team-10/edit/main/docs/odes/Applications.md" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/Stefmeff/ASC-ODE-team-10/issues/new?title=Issue%20on%20page%20%2Fodes/Applications.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/odes/Applications.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>3. Applications</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">3. Applications</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mass-spring-system">3.1 Mass-Spring System</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#electronic-circuit">3.2 Electronic Circuit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#legendre-polynomials">3.3 Legendre Polynomials</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mass-spring-pendulum">3.4 Mass-Spring Pendulum</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="applications">
<h1>3. Applications<a class="headerlink" href="#applications" title="Permalink to this heading">#</a></h1>
<p>In this chapter, we demonstrate the usage of our ODE library by simulating <strong>mechanical and electrical systems</strong>, simulating their temporal behaviour by numerically solving their underlying ODE’s.</p>
<section id="mass-spring-system">
<h2>3.1 Mass-Spring System<a class="headerlink" href="#mass-spring-system" title="Permalink to this heading">#</a></h2>
<p>We start with a <strong>simple mechanical system</strong>: a mass attached to a spring. Using Newton’s law:
$<span class="math notranslate nohighlight">\(my''(t) = -ky(t)\)</span>$
where <strong>m</strong> is the mass, <strong>k</strong> the stiffness of the spring, and <em>y(t)</em> the displacement of the mass.  We express this relationship as a first order system:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix} y \\ y' \end{bmatrix}' = \begin{bmatrix} y' \\ -\frac{k}{m}y \end{bmatrix}\end{split}\]</div>
<p>The system is implemented in <code class="docutils literal notranslate"><span class="pre">demos/test_ode</span></code> as the <code class="docutils literal notranslate"><span class="pre">MassSpring</span></code> class, which evaluates the RHS for any given state. Using our different time-stepping methods we can calculate and plot the change in position over time and the phase plot. To execute the code, compile it as stated in the intro and call:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="o">./</span><span class="n">test_ode</span> <span class="p">[</span><span class="o">--</span><span class="n">system</span> <span class="o">&lt;</span><span class="nb">type</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">method</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">stages</span> <span class="n">N</span><span class="p">]</span>
</pre></div>
</div>
<p>Where the command line options are:</p>
<ul class="simple">
<li><p>s: MassSpring, ElectricNetwork</p></li>
<li><p>m: ExplicitEuler, ImplicitEuler, ImprovedEuler, CrankNicolson, ExpRungeKutta,ImpRungeKutta</p></li>
<li><p>k: Number of stages for Runge-Kutta methods</p></li>
</ul>
<p>e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">test_ode</span> <span class="o">-</span><span class="n">s</span> <span class="n">MassSpring</span> <span class="o">-</span><span class="n">m</span> <span class="n">ExplicitEuler</span>
</pre></div>
</div>
<p>After calculating the results for the different time-stepping methods (<em>Explicit-, Implicit-, Improved-Euler</em> and <em>Crank-Nicolson</em>), we can see their respective behaviour using different number of steps <strong>s</strong> in the plots below:</p>
<ul>
<li><p><strong>Time-Stepping Methods (5 steps):</strong></p>
<a class="reference internal image-reference" href="../_images/massspring_position_steps5.png"><img alt="../_images/massspring_position_steps5.png" src="../_images/massspring_position_steps5.png" style="width: 45%;" /></a>
<a class="reference internal image-reference" href="../_images/massspring_phase_steps5.png"><img alt="../_images/massspring_phase_steps5.png" src="../_images/massspring_phase_steps5.png" style="width: 45%;" /></a>
</li>
<li><p><strong>Time-Stepping Methods (50 steps):</strong></p>
<a class="reference internal image-reference" href="../_images/massspring_position_steps50.png"><img alt="../_images/massspring_position_steps50.png" src="../_images/massspring_position_steps50.png" style="width: 45%;" /></a>
<a class="reference internal image-reference" href="../_images/massspring_phase_steps50.png"><img alt="../_images/massspring_phase_steps50.png" src="../_images/massspring_phase_steps50.png" style="width: 45%;" /></a>
</li>
<li><p><strong>Time-Stepping Methods (200 steps):</strong></p>
<a class="reference internal image-reference" href="../_images/massspring_position_steps200.png"><img alt="../_images/massspring_position_steps200.png" src="../_images/massspring_position_steps200.png" style="width: 45%;" /></a>
<a class="reference internal image-reference" href="../_images/massspring_phase_steps200.png"><img alt="../_images/massspring_phase_steps200.png" src="../_images/massspring_phase_steps200.png" style="width: 45%;" /></a>
</li>
</ul>
<p>As one can see in the plots above, low stepsizes lead to really rough approximations of the solution. As step size increases the results get more and more accurate. One can also compare the results across methods. As one can see <em>Improved Euler</em> or <em>Crank-Nicolson</em> provide a much better approximation of the real solution (which would be a periodically swinging mass) than for example <em>Explicit Euler</em>, which swings with increasing amplitude as time progesses.</p>
</section>
<section id="electronic-circuit">
<h2>3.2 Electronic Circuit<a class="headerlink" href="#electronic-circuit" title="Permalink to this heading">#</a></h2>
<p>As a second example we look at a simple RC circuit. By Kirchhoff’s law, the voltage <span class="math notranslate nohighlight">\(U_C(t)\)</span> across the capacitor satisfies:</p>
<div class="math notranslate nohighlight">
\[RC\frac{dU_C}{dt} + U_C(t) = U_0(t)\]</div>
<p>where <strong>R</strong> is the resistance, <strong>C</strong> is the capacitance, and <span class="math notranslate nohighlight">\(U_0(t)\)</span> is the input voltage. Rearranging as a first-order ODE:</p>
<div class="math notranslate nohighlight">
\[\frac{dU_C}{dt} = \frac{1}{RC}(U_0(t) - U_C(t))\]</div>
<a class="reference internal image-reference" href="../_images/RC_Circuit.png"><img alt="../_images/RC_Circuit.png" src="../_images/RC_Circuit.png" style="width: 30%;" /></a>
<p>The system is implemented in <code class="docutils literal notranslate"><span class="pre">demos/test_ode.cpp</span></code> as the <code class="docutils literal notranslate"><span class="pre">ElectricNetwork</span></code> class. Parameters are set to <span class="math notranslate nohighlight">\(R=C=1\)</span> and the input voltage is <span class="math notranslate nohighlight">\(U_0(t) = \cos(100\pi t)\)</span>. Since the RC-circuit implements a low pass filter, we expect high-frequent input signals to decrease in amplitude at the output. We simulate the systems behaviour again by calling:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">test_ode</span> <span class="o">-</span><span class="n">s</span> <span class="n">ElectricNetwork</span> <span class="p">[</span><span class="o">--</span><span class="n">method</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">stages</span> <span class="n">N</span><span class="p">]</span>
</pre></div>
</div>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p><strong>Time-Stepping Methods (50 steps):</strong></p></th>
<th class="head text-center"><p><strong>Time-Stepping Methods (100 steps):</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><a class="reference internal" href="../_images/voltage_plot_steps50.png"><img alt="../_images/voltage_plot_steps50.png" src="../_images/voltage_plot_steps50.png" style="width: 100%;" /></a></p></td>
<td class="text-center"><p><a class="reference internal" href="../_images/voltage_plot_steps100.png"><img alt="../_images/voltage_plot_steps100.png" src="../_images/voltage_plot_steps100.png" style="width: 100%;" /></a></p></td>
</tr>
</tbody>
</table>
</div>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p><strong>Time-Stepping Methods (200 steps):</strong></p></th>
<th class="head text-center"><p><strong>Time-Stepping Methods (20000 steps):</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><a class="reference internal" href="../_images/voltage_plot_steps200.png"><img alt="../_images/voltage_plot_steps200.png" src="../_images/voltage_plot_steps200.png" style="width: 100%;" /></a></p></td>
<td class="text-center"><p><a class="reference internal" href="../_images/voltage_plot_steps20000.png"><img alt="../_images/voltage_plot_steps20000.png" src="../_images/voltage_plot_steps20000.png" style="width: 100%;" /></a></p></td>
</tr>
</tbody>
</table>
</div>
<p>We can see that the performance for a low number of steps leads to really bad performance in this case. This is because the larger stepsizes produce errors for both
numerical approximation and plotting the values of a function with a high frequency.
In oder to accurately capture a signal with a frequency of <span class="math notranslate nohighlight">\(f_{max}=100\pi\)</span> we need to consider <strong>Nyquist Criterion</strong>, were the sampling rate <span class="math notranslate nohighlight">\(f_s\)</span> for a signal of frequence <span class="math notranslate nohighlight">\(f_{max}\)</span> needs to be at least:
$<span class="math notranslate nohighlight">\(f_s \geq 2*f_{max}\)</span>$</p>
<p>For a n=20000 steps, we see a accurate represantation of the output signal <span class="math notranslate nohighlight">\(U_C(t)\)</span>, which is a signal of the same frequency, but highly reduced in amplitude. We can also see the same behaviour for explicit and implicit Runge Kutta for different number of stages:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p><strong>Time-Stepping Methods (20000 steps):</strong></p></th>
<th class="head text-center"><p><strong>Time-Stepping Methods (20000 steps):</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><a class="reference internal" href="../_images/ExplicitRunge_voltage_plot_steps20000.png"><img alt="../_images/ExplicitRunge_voltage_plot_steps20000.png" src="../_images/ExplicitRunge_voltage_plot_steps20000.png" style="width: 100%;" /></a></p></td>
<td class="text-center"><p><a class="reference internal" href="../_images/ImplicitRunge_voltage_plot_steps20000.png"><img alt="../_images/ImplicitRunge_voltage_plot_steps20000.png" src="../_images/ImplicitRunge_voltage_plot_steps20000.png" style="width: 100%;" /></a></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="legendre-polynomials">
<h2>3.3 Legendre Polynomials<a class="headerlink" href="#legendre-polynomials" title="Permalink to this heading">#</a></h2>
<p>We demonstrate the usage of the class <code class="docutils literal notranslate"><span class="pre">AutoDiff</span></code>, by expressing the Legendre-polynomials up to order 5 in intervall <span class="math notranslate nohighlight">\(-1 \leq x \leq 1\)</span> and evaluating the values and derivatives. We implement the evaluation of the values and derivates in the file <code class="docutils literal notranslate"><span class="pre">demos/demo_autodiff.cpp</span></code>, and store the results at the discrete points x in a text file.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">ofstream</span><span class="w"> </span><span class="n">outfile</span><span class="p">(</span><span class="s">&quot;../outputs/Legendre/legendre_polynomials.txt&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">-1.0</span><span class="p">;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mf">0.01</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">AutoDiff</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;</span><span class="w"> </span><span class="n">adx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Variable</span><span class="o">&lt;</span><span class="mi">0</span><span class="o">&gt;</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="w">        </span><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">AutoDiff</span><span class="o">&lt;</span><span class="mi">1</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">P</span><span class="p">;</span>
<span class="w">        </span><span class="n">LegendrePolynomials</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">adx</span><span class="p">,</span><span class="w"> </span><span class="n">P</span><span class="p">);</span>
<span class="w">        </span><span class="n">outfile</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">&lt;</span><span class="n">P</span><span class="p">.</span><span class="n">size</span><span class="p">();</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">outfile</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;,&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">value</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;,&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">deriv</span><span class="p">()[</span><span class="mi">0</span><span class="p">];</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">outfile</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">outfile</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
</pre></div>
</div>
<p>If we execute <code class="docutils literal notranslate"><span class="pre">plotlegendre.py</span></code> we can view the legendre Polynomials up to order 5 and its derivatives.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p><strong>Legendre Polynomials:</strong></p></th>
<th class="head text-center"><p><strong>Derivative:</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><a class="reference internal" href="../_images/legendre_polynomials.png"><img alt="../_images/legendre_polynomials.png" src="../_images/legendre_polynomials.png" style="width: 100%;" /></a></p></td>
<td class="text-center"><p><a class="reference internal" href="../_images/legendre_polynomials_derivatives.png"><img alt="../_images/legendre_polynomials_derivatives.png" src="../_images/legendre_polynomials_derivatives.png" style="width: 100%;" /></a></p></td>
</tr>
</tbody>
</table>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="mass-spring-pendulum">
<h1>3.4 Mass-Spring Pendulum<a class="headerlink" href="#mass-spring-pendulum" title="Permalink to this heading">#</a></h1>
<p>For this example, we want to simulate the behaviour of mass-spring systems, where point masses are connected to each other with springs or mass-less sticks. For this we utilize the class <code class="docutils literal notranslate"><span class="pre">MassSpringSystem</span></code> implemented in <code class="docutils literal notranslate"><span class="pre">mechsystem/mass_spring.cpp</span></code>. This class represents a mechanical system of interconnected point masses and fix points. The class <code class="docutils literal notranslate"><span class="pre">MSS_Functions</span></code> implements the right-hand-side function for the mass-spring system and can be used to numerically approximate and simulate the systems behaviour.</p>
<p>To calculate the forces on the point masses <strong><span class="math notranslate nohighlight">\(m_i\)</span></strong> with position <span class="math notranslate nohighlight">\(x_i(t)\)</span>, we first consider the potential energy <strong>U(x)</strong>:
$<span class="math notranslate nohighlight">\(\sum_i m_i\,g x_{i,z},\)</span>$</p>
<p>For the energy stored in the spring <span class="math notranslate nohighlight">\(k_ij\)</span> connecting point masses <span class="math notranslate nohighlight">\(m_i\)</span> and <span class="math notranslate nohighlight">\(m_j\)</span> we get:</p>
<div class="math notranslate nohighlight">
\[\sum_{k_{ij}} \frac{1}{2} k_{ij} ( |x_i - x_j | - l_{ij} )^2,
\]</div>
<p>The force acting on a mass can then be expressed as:
$<span class="math notranslate nohighlight">\(
F_i := -\frac{\partial U}{\partial x_i}(x)
\)</span>$</p>
<p>Dividing the force my the mass gives us the accelleration. If we assume mass-less sticks of length <strong>l</strong> connecting the point masses, we get the following constraint:
$<span class="math notranslate nohighlight">\(
0 = g(x) := | x - x_0 | - l,
\)</span><span class="math notranslate nohighlight">\(
We can then define the Lagrange function:
\)</span><span class="math notranslate nohighlight">\(
L(x, \lambda) = -U(x) + \left&lt; \lambda , g(x) \right&gt;
\)</span><span class="math notranslate nohighlight">\(
and derive the equation:
\)</span><span class="math notranslate nohighlight">\(\begin{aligned}
m_i\ddot x_i &amp;= \frac{\partial}{\partial x_i} L(x, \lambda) \\
0 &amp;= \nabla_\lambda L(x, \lambda)
\end{aligned}\)</span>$</p>
<p>We can then define such mechinal systems like this:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">MassSpringSystem</span><span class="o">&lt;</span><span class="mi">2</span><span class="o">&gt;</span><span class="w"> </span><span class="n">mss</span><span class="p">;</span>
<span class="n">mss</span><span class="p">.</span><span class="n">setGravity</span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="mi">0</span><span class="p">,</span><span class="mf">-9.81</span><span class="p">}</span><span class="w"> </span><span class="p">);</span>
<span class="k">auto</span><span class="w"> </span><span class="n">fA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mss</span><span class="p">.</span><span class="n">addFix</span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">0.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">);</span>
<span class="k">auto</span><span class="w"> </span><span class="n">mA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mss</span><span class="p">.</span><span class="n">addMass</span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">1.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">);</span>
<span class="k">auto</span><span class="w"> </span><span class="n">mB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mss</span><span class="p">.</span><span class="n">addMass</span><span class="p">(</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="mf">2.0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.0</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">);</span>

<span class="n">mss</span><span class="p">.</span><span class="n">add</span><span class="w"> </span><span class="p">(</span><span class="n">Spring</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">20000</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">fA</span><span class="p">,</span><span class="w"> </span><span class="n">mA</span><span class="p">)))</span>
<span class="n">mss</span><span class="p">.</span><span class="n">add</span><span class="w"> </span><span class="p">(</span><span class="n">DistanceConstraint</span><span class="p">(</span><span class="mi">1</span><span class="p">,(</span><span class="n">mA</span><span class="p">,</span><span class="n">mB</span><span class="p">)))</span>
</pre></div>
</div>
<p>By again implementing the right-hand side function of the mass spring system as  a <code class="docutils literal notranslate"><span class="pre">NonlinearFunction</span></code> in <code class="docutils literal notranslate"><span class="pre">MSS_Functions</span></code>, allows us to use numerical methods to approximate the systems behaviour.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="kt">int</span><span class="w"> </span><span class="n">D</span><span class="o">&gt;</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MSS_Function</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">NonlinearFunction</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">MassSpringSystem</span><span class="o">&lt;</span><span class="n">D</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">mss</span><span class="p">;</span>
<span class="k">public</span><span class="o">:</span>
<span class="w">  </span><span class="n">MSS_Function</span><span class="w"> </span><span class="p">(</span><span class="n">MassSpringSystem</span><span class="o">&lt;</span><span class="n">D</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">_mss</span><span class="p">)</span>
<span class="w">    </span><span class="o">:</span><span class="w"> </span><span class="n">mss</span><span class="p">(</span><span class="n">_mss</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">}</span>

<span class="w">  </span><span class="k">virtual</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">dimX</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="w">  </span><span class="k">virtual</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="nf">dimF</span><span class="p">()</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>

<span class="w">  </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="n">VectorView</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">VectorView</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">f</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="w">  </span><span class="k">virtual</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">evaluateDeriv</span><span class="p">(</span><span class="n">VectorView</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">MatrixView</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">)</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">override</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p><strong>Double Pendulum</strong></p></th>
<th class="head text-center"><p><strong>Spring Chain:</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><a class="reference internal" href="../_images/DoublePendulum.gif"><img alt="../_images/DoublePendulum.gif" src="../_images/DoublePendulum.gif" style="width: 100%;" /></a></p></td>
<td class="text-center"><p><a class="reference internal" href="../_images/ChainPendulum.gif"><img alt="../_images/ChainPendulum.gif" src="../_images/ChainPendulum.gif" style="width: 75%;" /></a></p></td>
</tr>
</tbody>
</table>
</div>
<p>TODO: Simulate other more complicated constructs using distance constraints via Lagrange multipliers.</p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./odes"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="TimeSteppingMethods.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">2. Time Stepping Methods</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">3. Applications</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#mass-spring-system">3.1 Mass-Spring System</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#electronic-circuit">3.2 Electronic Circuit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#legendre-polynomials">3.3 Legendre Polynomials</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#mass-spring-pendulum">3.4 Mass-Spring Pendulum</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By The Jupyter Book community
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  Documentation for the ASC-ODE project (Team 10, TU Wien)
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>